<!DOCTYPE html>
<html>
  <head>
    <title>React Native</title>
    <meta charset="utf-8">
    <link href="remark-bekk/dist/bekk.css" type="text/css" rel="stylesheet">
    <style>
      .small-img img{
        width: 275px;
      }
       .full-img img{
        width: 100%;
      }
    </style>
  </head>
  <body>
    <textarea id="source">

class: front-page

# React Native
## Workshop

Bekk Open Fagdag

15.04.2016

---

class: agenda

# Agenda

* Intro
* Syntaks og styling
* Redux
* Navigasjon
* Instant deploy?
* Deres tur!

???

## Før jeg setter igang. Hvem er kjent med React, RN, Redux?
## Skal prøve å være rask, så dere får så mer tid til å kode

---

# Intro - Native

## Lansert for iOS i januar 2015 og for Android i september av Facebook
## Nå også for Windows (UWP)
## Open Source
## Problemer med (tradisjonell) native
- Treg utviklingsyklus
- Treg deploymentprosess
- Separate team for hver platform

???

## Av Facebook, aktivt brukt.
## Rykende ferskt fra F8-konferansen til Facebook. Kan bruke RN-komponenter i UWP-apps. Støtte i Visual Studio Code 
## Allerede stort community. PR, React komponenter. 
## Noen har også lagt til OSX desktop støtte
## Hyppige releases. Flere nye versjoner i løpet av de ukene vi jobbet med denne workshopen

## Funket ikke å pakke inn webapps lengre. Webben er ikke klar enda.
## Kan gjøre mye kult med native, men de synes det gikk for treigt å utvikle native. Treigere utviklingsmiljø. 1 minutt å bygge.
##Utviklere må kunne flere språk, apier og verktøy. Rett og slett ikke smidig nok ut ifra det de var vant til fra webben. Måtte kjenne og implementere businesslogikk dobbelt.


---

# Intro - Kryssplattform

## Problemer med kryssplattform
- Dårligere ytelse
- Ikke (alltid) native look & feel
- Dårlig verktøystøtte og debug
- Begrenset funksjonalitet

???

## Facebook har jo prøvd litt av hvert. Pakket inn appen i WebView en stund.

---

# Hva er React Native?

## Bygger på React.js
## Samme prinsipper, med virtuell DOM
## Web-DOM er byttet ut med native komponenter
## _Learn_ once, write anywhere

???

## Moduler, virtuell DOM og deklarativt API. Vi beskriver hva programmet skal gjøre, ikke hvordan.
## Må ikke rendre til DOM. 
## Tydelig i nye versjoner av React.js, der React og ReactDOM splittes
## IKKE write once, der altså. Men det ligger til rette for gjenbruk. F.eks apier, events, business-logikk. Men ikke nødvendigvis view-kode.
## Skal være kjent for utviklere som kommer fra JS og React.
## Kan gjenbruke komponenter fra webben, og i tillegg får tilgang til platformkomponenter
## Så i mange tilfeller er det npm install, tut & kjør

---

# Ikke ulikt React.js 1/2

```html
<div>
  <span>Hei sveis</span>
  <button>Trykk på meg</button>
</div>
```

```html
<View>
  <Text>Hei sveis</Text>
  <TouchableOpacity>
    <Text>
      Trykk på meg
    </Text>
  </TouchableOpacity>
</View>
```

???

## Knapp

---
# Ikke ulikt React.js 2/2

```html
<input
  type="text"
  value={this.state.text}
  onChange={(text) => this.setState({text})}
/>
```

```html
 <TextInput
   value={this.state.text}
   onChangeText={(text) => this.setState({text})}
/>
```

## Noen er platformspesifikke:
```html
<SwitchIOS />
<SwitchAndroid />
```

???

## Input
## React-Native bruker "Controlled Components", så man har en 'value' prop

---

class: cols two

# Komponenter

.col[
## De vanligste komponentene og API-ene er tilgjengelige
## Men kan skrive egne komponenter i native kode og eksponere
## Mange finnes allerede som npm-moduler
]

.col[
.small-img[![](img/ReactComponents.png)]
]

???
## Orientation-change, 3D-touch (er på vei) ikke implementert enda 

---

# Ikke webapp

## Ikke en React.js-app pakket inn i WebView
## Fullt ut native plattformkomponenter
## Optimaliseringer
- JS kjører på JavaScriptCore
- JS kjøres asynkront, utenfor UI-tråden. 
- JS til Native via "bridge".

???
## At det er basert på React.js betyr ikke at det er en React-app pakket inn i et WebView
## Som sagt, DOM er byttet ut.
## Ikke WebView, så det føles native. Deler av Facebook-appen er RN. Kan dere gjette hvilken? Events/arrangementer
## Sender kommandoer i batcher til UI-tråden.
## Flere tråder, i motsetning til web. Dekode bilder, lagre til disk, gjøre layoutberegninger utenfor UI-tråden. => Responsivt
## Målet for Facebook har hele tiden vært 60 fps, for snappy UI

---

# Bridge
.col[
.full-img[![](img/ReactBridge.png)]
]

???

## Får input, click.
## Samler informasjon, serialiserer det, og sender til JSCore
## JS prosesserer event og lager en liste over native kommandoer.
## Dette serialiseres og sendes tilbake til native
## Prosesserer kommandoene og oppdaterer UI

https://speakerdeck.com/frantic/react-native-under-the-hood

---
#Hva trenger man?

* XCode
* Android-SDK
* Node 4.x
* npm 3
* react-native-cli
* Det du skriver JS i

???

## Sublime, Atom, Nuclide, IntelliJ etc

---

class: cols two

# Utviklingsmiljø!

.col[
## React Native kommer med Packager
## Oppdateringer med ⌘-R
## Debugging i Chrome. ⌘-D (iOS) / F2(Android)
## Tydelige feilmeldinger
]

.col[
.small-img[![](img/ReactNative4.png)]
]

???

## Packager bygger appen, og står i bakgrunnen og venter på endringer.
## Noe av det mange sliter med er utviklingsmiljø. Mange som ikke er komfortable med XCode
## Kan kjøre opp i Chromes V8 (kommuniserer med native via WebSockets) og bruke vanlig debugger
## Hvis man utvikler på enhet kan man riste på den for å få opp utviklervalg
---

# Styling - Kjent og kjært fra CSS

## "Inline styles"
## camelCasing
## margin, marginBottom, paddingBottom, borderRadius, width, height
## backgroundColor, borderColor, fontSize, fontWeight

```html
<Text style={{
  color: 'black', 
  fontSize: 20,
  fontWeight: 'bold',
  marginBottom: 10}}>
  Velkommen til Bekk Open Fagdag
</Text>
```

???

## En javascript-implementasjon av CSS
## De fleste vanlige CSS-props er på plass
## Inline styles med JS-objekter

---

# Styling - FLEXBOX

## Plassering av elementer gjøres med Flexbox
## Basert på Flexbox fra css
## flex direction, flex, align items, align self, justify content, ...


???

## En javascript-implementasjon av Flexbox. Baserer seg på CSS-standarder
## Så man har containere som spesifiserer barnenoder, og man deler opp i kolonner eller rader.
## Går fort igjennom nå, mer som et oppslagsverk for oppgavene, linker til mer dokumentasjon finnes sammen med oppgavene

---

class: cols two

# FLEXBOX - direction

## flexDirection: column (default)
.col[
```javascript
class Flexbox extends Component {
  render() {
    return (
      <View style={{flex: 1, 
      flexDirection: 'column'}}>
        <View style={{flex: 1, 
        backgroundColor: '#252525'}}>
        </View>
        <View style={{flex: 1, 
        backgroundColor: '#e9555f'}}>
        </View>
        <View style={{flex: 1, 
        backgroundColor: '#36bdb2'}}>
        </View>
      </View>
    );
  }
}
```
]

.col[
.small-img[![](img/flex_column.png)]
]

???

## Hvilken akse skal barnenodene legges ut.
## Column: topp til bunn

---
class: cols two

# FLEXBOX - direction

## flexDirection: row
.col[
```javascript
class Flexbox extends Component {
  render() {
    return (
      <View style={{flex: 1, 
      flexDirection: 'row'}}>
        <View style={{flex: 1, 
        backgroundColor: '#252525'}}>
        </View>
        <View style={{flex: 1, 
        backgroundColor: '#e9555f'}}>
        </View>
        <View style={{flex: 1, 
        backgroundColor: '#36bdb2'}}>
        </View>
      </View>
    );
  }
}
```
]

.col[
.small-img[![](img/flex_row.png)]
]

???

## Venstre til høyre i en rad

---
class: cols two

# FLEXBOX - justify content

## justifyContent: flex-start (default)
.col[
```html
      <View style={{flex: 1}}>
        <View style={{flex: 1, 
        justifyContent='flex-start', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/justifyContent_flexStart.png)]
]

???

## This defines the alignment along the main axis
## Hvordan skal elementer legges ut i containeren?
## Gjelder barn

---

class: cols two

# FLEXBOX - justify content

## justifyContent: center
.col[
```html
      <View style={{flex: 1}}>
        <View style={{flex: 1, 
        justifyContent='center', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/justifyContent_center.png)]
]

---

class: cols two

# FLEXBOX - justify content

## justifyContent: flex-end
.col[
```html
      <View style={{flex: 1}}>
        <View style={{flex: 1, 
        justifyContent='flex-end', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
          <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/justifyContent_flexEnd.png)]
]

---

class: cols two

# FLEXBOX - justify content

## justifyContent: space-around
.col[
```html
      <View style={{flex: 1}}>
        <View style={{flex: 1, 
        justifyContent='space-around', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
          <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/justifyContent_spaceAround.png)]
]

---

class: cols two

# FLEXBOX - justify content

## justifyContent: space-between
.col[
```html
      <View style={{flex: 1}}>
        <View style={{flex: 1, 
        justifyContent='space-between', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/justifyContent_spaceBetween.png)]
]

---


class: cols two

# FLEXBOX - align items

## align-items: stretch (default)
.col[
```html
     <View style={{flex: 1}}>
        <View style={{flex: 1, 
        alignItems:'stretch', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/alignItems_stretch.png)]
]

???
## Gjelder også barnenoder. Tilsvarende for elementer er alignSelf

---

class: cols two

# FLEXBOX - align items

## align-items: flex-start
.col[
```html
```html
     <View style={{flex: 1}}>
        <View style={{flex: 1, 
        alignItems:'flex-start', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/alignItems_flexStart.png)]
]

---


class: cols two

# FLEXBOX - align items

## align-items: flex-end
.col[
```html
 ```html
     <View style={{flex: 1}}>
        <View style={{flex: 1, 
        alignItems:'flex-end', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/alignItems_flexEnd.png)]
]

---


class: cols two

# FLEXBOX - align items

## align-items: center
.col[
```html
```html
     <View style={{flex: 1}}>
        <View style={{flex: 1, 
        alignItems:'center', 
        backgroundColor: '#e9555f', 
        paddingTop:50}}>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
         <Text style={{
          backgroundColor: '#36bdb2', 
          padding:10}}>Hei på dere</Text>
        </View>
      </View>
```
]

.col[
.small-img[![](img/alignItems_center.png)]
]

---


class: cols two

# FLEXBOX - flex

## flex: 1, flex: 1
.col[
```html
      <View style={{flex: 1}}>
        <View style={{flex: 1, 
        backgroundColor: '#e9555f'}}>
        </View>
         <View style={{flex: 1, 
         backgroundColor: '#36bdb2'}}>
        </View>
      </View>
```
]

.col[
.small-img[![](img/flex_1_1.png)]
]


???

## Hvor mye plass skal elementet ta?
## Dersom alle har lik verdi tar de like stor plass
## 0 => Så mye plass elementet trenger
## >0 Så mye plass som mulig


---

class: cols two

# FLEXBOX - flex

## flex: 2, flex: 1
.col[
```html
      <View style={{flex: 1}}>
        <View style={{flex: 2, 
        backgroundColor: '#e9555f'}}>
        </View>
         <View style={{flex: 1, 
         backgroundColor: '#36bdb2'}}>
        </View>
      </View>
```
]

.col[
.small-img[![](img/flex_2_1.png)]
]

---

class: cols two

# Style-objekter

## Vanlig å trekke ut i style-objekter
.col[
```html
<View style={styles.row}>
  <Image
    source={
    {uri: 'http://inter.net/workshop.png'}}
    style={styles.image}
  />
  <View style={styles.text}>
    <Text style={styles.title}>
      Hei på dere!
    </Text>
    <Text style={styles.subtitle}>
      Velkommen til Bekk Open Fagdag
    </Text>
  </View>
</View>
```
]

.col[
```javascript
var styles = StyleSheet.create({
  row: { flexDirection: 'row', margin: 40 },
  image: { width: 40, height: 40, 
  marginRight: 10 },
  text: { flex: 1, justifyContent: 'center'},
  title: { fontSize: 11, fontWeight: 'bold' },
  subtitle: { fontSize: 10 },
});
```
]

---

# FLEXBOX

## Kan ha flere "klasser"
```html
<View style={[styles.base, styles.background]} />
```

## Og conditional klasser
```html
<View style={[styles.base, this.state.active && styles.active]} />
```

???

## Exportere moduler, f.eks. base-styling

---


# State/Redux

## En enklere implementasjon av Flux
## Single store
## Actions - for å gjøre endringer på state
## Reducers - returnerer ny state basert på action 


???

## State container. Noe av det fine med RN. At man kan bruke eksisterende moduler og konsepter
## 3 prinsipper
## Single source of truth - En store
## State is read-only - Kan kun endre state ved å sende inn en action om hva som skjedd
## Changes are made with pure functions - Reducer er en mapping mellom action og state. Returnerer neste state.

---

# State/Redux - Single store

## app.js

```javascript
import { createStore } from 'redux';
import { Provider } from 'react-redux';
import rnWorkshop from './reducers/reducers';
const store = createStore(rnWorkshop);

<Provider store={store}>
  <View>....</View>
</Provider>
```

???

# Views lytter på state

---

# State/Redux - Actions

## actions.js
```javascript
export const setUsername = username => ({ type: SET_USER_NAME, username });
```
## someComponent.js
```javascript

import { setUsername } from '../actions/actions';

...
store.dispatch(setUsername("Mark Z."));
...

```

???

## Hva har skjedd?
 

---

# State/Redux - Reducers

## reducer.js
```javascript
function messageReducer(state = initialState, action) {
  switch (action.type) {
      case SET_USER_NAME:
      return Object.assign({}, state, { username: action.username });
  }
}
```

???

## Reducer er en mapping mellom action og state. Returnerer neste state.
## Skal ikke klusse med state, men returnere ny state.


---

# Ikke fått til alt ...

## Navigator, NavigatorIOS, NavigatorExperimental, WTF?

???

## Navigator: Uklart API, og lite dokumenterte best practices. (NavigationBar bl.a)
- Ikke like smoothe animasjoner
## NavigatorIOS: Begrenset API, og ikke supportert eller videreutviklet av Facebook
## NavigatorExperimental: Nytt. 

---


# Bruk av Navigator

## Viktigste funksjoner:
`initialRoute` - startpunktet for Navigator

`renderScene` - beskrive hvordan en side skal rendres basert på hvilken route som er aktiv

`push(route)` - naviger til ny side/komponent

???

## Routeobjekt som identifiserer enside

---

# Bruk av Navigator

## Vi har pakket inn Navigator, slik at en del av funksjonaliteten er abstrahert bort.

## Init (app.js):
```
import Navigator from './components/navigation/navigator';

<Navigator ref="navigator" />
```

## Bruk:
```
import { navigateTo } from '../actions/actions';
import NewMessage from '../new-message';

dispatch(navigateTo({component: NewMessage, title: 'Skriv ny'});
```

???

## Bruker Navigator, men har abstrahert bort oppsett av navigator og navigationBar.
## Viktigste funksjoner, transisjoner + endel config for look and feel (animasjoner, navigation bar layout)
## Bruk: Vi har lagt navigatoren i Redux State, så send inn en komponent til navigateTo-action.
## Bruker Babel, så ES6/7 kan brukes

---

# Instant deploy av JS?

## AppHub, CodePush (MS)
## I henhold til Apple guidelines

> ... The only exceptions to the
foregoing are scripts and code downloaded and run by Apple's built-in WebKit framework or
JavascriptCore, provided that such scripts and code do not change the primary purpose of the
Application ...

.small-img[![](img/AppHub3.png)]

???

## Nevnte i innledingen treg deploymentprosess.
## Kjører på JSC, og guidelines understreker at det kan bli endret etter appen er releaset
## Dersom det er kun JS-endringer kan disse pushes ut utenom App Store, også til et begrenset sett med brukere

---

class: middle center

# DERES TUR!

---

# Linker

## https://facebook.github.io/react-native/docs/getting-started.html
## https://github.com/bekk/react-native-workshop


    </textarea>
    <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js">
    </script>
    <script src="node_modules/remark-bekk/vendor/remark.min.js" type="text/javascript"></script>
    <script type="text/javascript">
      var slideshow = remark.create({
        ratio: '16:9',
        highlightStyle: 'monokai'
      });
    </script>
  </body>
</html>